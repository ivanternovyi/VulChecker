require 'rails_helper'

RSpec.describe Vulnerability, type: :model do
  let(:vulnerability) { FactoryBot.create(:vulnerability, published_at: Date.today) }
  let(:vulnerability_previous) { FactoryBot.create(:vulnerability, published_at: Date.yesterday) }

  describe 'newest scope' do
    it "should return newest vulnerabilities" do
      expect(Vulnerability.newest).not_to be vulnerability_previous
    end
  end

  describe 'newest_date class method' do
    it "should return newest published_at" do
      expect(Vulnerability.newest_date).to eq(vulnerability.published_at)
    end
  end
end
